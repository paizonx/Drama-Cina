<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Drachin - Nonton Stream</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
<style>
/* --- CSS ALA VIDSTREAM PRO (RESPONSIF BAGUS) --- */
:root { --bg-main: #060b14; --bg-card: #131b2e; --accent: #e62117; --text-main: #ffffff; --text-muted: #94a3b8; --border: #1e293b; }
body { margin: 0; background-color: var(--bg-main); color: var(--text-main); font-family: 'Inter', sans-serif; overflow-x: hidden; }
a { text-decoration: none; color: inherit; }
*{ box-sizing: border-box; }

/* LAYOUT UTAMA */
.container { max-width: 1100px; margin: 0 auto; padding: 0 15px; }

/* NAVBAR */
.navbar { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid var(--border); margin-bottom: 20px; }
.brand { font-weight: 800; font-size: 22px; color: #fff; display: flex; align-items: center; gap: 5px; }
.brand span { color: var(--accent); }
.nav-btn { background: #333; padding: 8px 15px; border-radius: 20px; font-size: 13px; font-weight: 600; }
.nav-vip { background: var(--accent); color: white; }

/* TEMPAT IKLAN NATIVE (WADAH KHUSUS) */
.ad-native-box { 
    background: #0f1623; 
    border: 1px dashed #333; 
    border-radius: 8px; 
    margin: 20px 0; 
    padding: 10px; 
    min-height: 120px; /* Tinggi minimum agar iklan punya tempat muncul */
    display: flex; align-items: center; justify-content: center; text-align: center;
}

/* GRID GALERI */
.gallery-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px; padding-bottom: 50px; }
@media(min-width: 600px){ .gallery-grid { grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); } }

/* CARD VIDEO */
.vid-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: 10px; overflow: hidden; display: flex; flex-direction: column; position: relative; }
.thumb-area { width: 100%; aspect-ratio: 16/9; background-color: #000; position: relative; overflow: hidden; }
.thumb-img { width: 100%; height: 100%; object-fit: cover; }
.duration { position: absolute; bottom: 6px; right: 6px; background: rgba(0,0,0,0.8); padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; }
.card-info { padding: 10px; }
.vid-title { font-size: 13px; font-weight: 600; margin: 0; line-height: 1.4; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; color: #eee; }

/* PLAYER PAGE */
#playerPage { display: none; }
.back-btn { display: inline-block; padding: 10px 0; color: var(--text-muted); cursor: pointer; font-size: 14px; }

/* FRAME PLAYER YANG MENYESUAIKAN HP */
.player-wrapper {
    position: relative;
    width: 100%;
    padding-bottom: 56.25%; /* Kunci agar Rasio 16:9 di semua layar */
    background: #000;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.5);
    margin-bottom: 20px;
}
.player-wrapper iframe, .player-wrapper video {
    position: absolute; top: 0; left: 0;
    width: 100%; height: 100%; border: 0;
}

/* TOMBOL AKSI (CUAN) */
.action-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
.btn-act { border: none; padding: 12px; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 14px; }
.btn-dl { background: #fff; color: #000; width: 100%; } /* Direct Link Utama */
.btn-share { background: #1e293b; color: #fff; }

/* REKOMENDASI (SIDEBAR) */
.rec-title { font-size: 16px; margin-bottom: 15px; border-left: 4px solid var(--accent); padding-left: 10px; }
.rec-list { display: flex; flex-direction: column; gap: 15px; }
.rec-item { display: flex; gap: 10px; align-items: flex-start; }
.rec-thumb { width: 120px; aspect-ratio: 16/9; background: #222; border-radius: 6px; overflow: hidden; flex-shrink: 0; }
.rec-info { font-size: 13px; font-weight: 600; line-height: 1.3; }

#loader { text-align: center; padding: 50px; color: #666; }
</style>

<script type="text/javascript" src="https://ridernoodleacerbity.com/c9/c0/46/c9c04611f8fb3b0b21da4b49fb98d3fa.js"></script>

</head>
<body>

<div class="container">
    
    <div class="navbar">
        <a href="?" class="brand"><span>▶</span> Drachin</a>
        <div style="display:flex; gap:10px;">
            <a href="https://ridernoodleacerbity.com/pu4v8n14t?key=280fea026bf240b90dd4b3343468c40f" target="_blank" class="nav-btn">Upload</a>
            <a href="https://ridernoodleacerbity.com/pu4v8n14t?key=280fea026bf240b90dd4b3343468c40f" target="_blank" class="nav-btn nav-vip">APP</a>
        </div>
    </div>

    <div id="loader">Memuat Video...</div>

    <div id="galleryPage" style="display:none;">
        
        <div class="ad-native-box">
            <script async="async" data-cfasync="false" src="https://ridernoodleacerbity.com/8754c34f20e587c8ef08a064d9f71e59/invoke.js"></script>
            <div id="container-8754c34f20e587c8ef08a064d9f71e59"></div>
        </div>

        <h2 style="margin-bottom:20px; font-size:18px;">Video Terbaru</h2>
        <div class="gallery-grid" id="gridTarget"></div>
    </div>

    <div id="playerPage">
        <div onclick="window.location.href='?'" class="back-btn">← Kembali ke Galeri</div>

        <div class="player-wrapper">
            <iframe id="dmPlayer" allow="autoplay; fullscreen" allowfullscreen style="display:none;"></iframe>
            <video id="webPlayer" controls playsinline style="display:none;"></video>
        </div>

        <h1 id="vidTitle" style="font-size:18px; margin-bottom:15px; line-height:1.4;">Judul Video</h1>

        <div class="action-buttons">
            <button class="btn-act btn-dl" onclick="window.open('https://ridernoodleacerbity.com/pu4v8n14t?key=280fea026bf240b90dd4b3343468c40f', '_blank')">
                ⬇ DOWNLOAD HD
            </button>
            <button class="btn-act btn-share">Share</button>
        </div>

        <div class="ad-native-box">
            <script async="async" data-cfasync="false" src="https://ridernoodleacerbity.com/8754c34f20e587c8ef08a064d9f71e59/invoke.js"></script>
            <div id="container-8754c34f20e587c8ef08a064d9f71e59"></div>
        </div>

        <div class="rec-title">Rekomendasi</div>
        <div class="rec-list" id="recList"></div>

        <div style="height:50px;"></div> </div>

</div>

<script>
    const DATABASE = "videos.txt"; 

    // UI ELEMENTS
    const loader = document.getElementById('loader');
    const galleryPage = document.getElementById('galleryPage');
    const playerPage = document.getElementById('playerPage');
    const gridTarget = document.getElementById('gridTarget');
    const recList = document.getElementById('recList');
    
    const dmPlayer = document.getElementById('dmPlayer');
    const webPlayer = document.getElementById('webPlayer');
    const vidTitle = document.getElementById('vidTitle');

    const urlParams = new URLSearchParams(window.location.search);
    const currentId = urlParams.get('id');

    async function init() {
        try {
            // Ambil data videos.txt
            const res = await fetch(DATABASE + '?t=' + Date.now());
            if (!res.ok) throw new Error("Gagal load videos.txt");
            const text = await res.text();
            
            const videos = text.split('\n')
                .filter(l => l.includes('|'))
                .map(l => {
                    const p = l.split('|');
                    return { id: p[0].trim(), title: p[1].trim() };
                });

            if (videos.length === 0) throw new Error("Video kosong");

            loader.style.display = 'none';

            if (currentId) {
                renderPlayer(currentId, videos);
            } else {
                renderGallery(videos);
            }

        } catch (err) {
            loader.innerHTML = "Error: " + err.message;
        }
    }

    function renderGallery(videos) {
        galleryPage.style.display = 'block';
        playerPage.style.display = 'none';
        
        let html = '';
        videos.forEach(v => {
            let thumb = `https://www.dailymotion.com/thumbnail/video/${v.id}`;
            if(v.id.startsWith('http')) thumb = 'https://via.placeholder.com/640x360/111/fff?text=VIDEO';
            
            html += `
            <a href="?id=${encodeURIComponent(v.id)}" class="vid-card">
                <div class="thumb-area">
                    <img src="${thumb}" onerror="this.src='https://via.placeholder.com/640x360/333/fff?text=Play'" class="thumb-img" loading="lazy">
                    <div class="duration">HD</div>
                </div>
                <div class="card-info">
                    <div class="vid-title">${v.title}</div>
                </div>
            </a>`;
        });
        gridTarget.innerHTML = html;
    }

    function renderPlayer(idRaw, videos) {
        galleryPage.style.display = 'none';
        playerPage.style.display = 'block';
        
        const id = decodeURIComponent(idRaw);
        const data = videos.find(v => v.id === id);
        const title = data ? data.title : "Nonton Video";
        
        vidTitle.innerText = title;
        document.title = title;

        // Reset Player
        dmPlayer.style.display = 'none'; dmPlayer.src = "";
        webPlayer.style.display = 'none'; webPlayer.pause();

        // LOGIKA DETEKSI (ID PENDEK/PANJANG = DAILYMOTION)
        if (id.startsWith('http')) {
            webPlayer.style.display = 'block';
            webPlayer.src = id;
            webPlayer.play();
        } else {
            dmPlayer.style.display = 'block';
            // Tambahkan param queue-enable=false biar gak autoplay video lain
            dmPlayer.src = `https://www.dailymotion.com/embed/video/${id}?autoplay=1&ui-logo=0&queue-enable=false&sharing-enable=false`;
        }

        // --- REKOMENDASI (HANYA 2 VIDEO) ---
        // Ambil video selain yg ditonton, lalu .slice(0, 2)
        const others = videos.filter(v => v.id !== id).slice(0, 2);
        
        let recHtml = '';
        others.forEach(v => {
            let thumb = `https://www.dailymotion.com/thumbnail/video/${v.id}`;
            if(v.id.startsWith('http')) thumb = 'https://via.placeholder.com/640x360/111/fff?text=VIDEO';
            
            recHtml += `
            <a href="?id=${encodeURIComponent(v.id)}" class="rec-item">
                <div class="rec-thumb">
                    <img src="${thumb}" onerror="this.src='https://via.placeholder.com/640x360/333/fff?text=Play'" style="width:100%; height:100%; object-fit:cover;">
                </div>
                <div class="rec-info">${v.title}</div>
            </a>`;
        });
        recList.innerHTML = recHtml;
    }

    init();
</script>

<script type="text/javascript">var _Hasync= _Hasync|| [];
_Hasync.push(['Histats.start', '1,4654540,4,0,0,0,00010000']);
_Hasync.push(['Histats.fasi', '1']);
_Hasync.push(['Histats.track_hits', '']);
(function() {
var hs = document.createElement('script'); hs.type = 'text/javascript'; hs.async = true;
hs.src = ('//s10.histats.com/js15_as.js');
(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(hs);
})();</script>
<noscript><a href="/" target="_blank"><img  src="//sstatic1.histats.com/0.gif?4654540&101" alt="web stats script" border="0"></a></noscript>

</body>
</html>
